(this["webpackJsonpreact-trois"]=this["webpackJsonpreact-trois"]||[]).push([[0],{138:function(e,t,a){e.exports=a(352)},351:function(e,t,a){},352:function(e,t,a){"use strict";a.r(t);a(139);var n=a(0),l=a.n(n),r=a(137),s=a.n(r),i=a(71),u=a(12),c=a(13),o=a(15),m=a(14),h=a(16),p=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return t.isNoTest()?null:l.a.createElement("p",{className:"Test"},l.a.createElement("strong",null,"Test Mode:")," ",t.allNames().join(", "))}}],[{key:"status",value:function(){return[]}},{key:"all",value:function(){return[{num:0,name:"noNewTiles"},{num:1,name:"allOnes"},{num:2,name:"displayScores"},{num:3,name:"showTileLogic"},{num:4,name:"noMovesLeft"},{num:5,name:"largeStartValues"}]}},{key:"isNoTest",value:function(){return 0===this.status().length}},{key:"isType",value:function(e){var t=this.status(),a=this.all(),n=!1;return 0!==t.length&&(t.forEach((function(t){var l=a.find((function(e){return e.num===t}));l&&l.name===e&&(n=!0)})),n)}},{key:"allNames",value:function(){var e=this.all(),t=this.status().map((function(t){return e.find((function(e){return e.num===t})).name}));return t}}]),t}(l.a.Component);function d(){return l.a.createElement("header",{className:"Header"},l.a.createElement("h1",null,"Trois"),l.a.createElement("p",null,"A React.js implementation and adaptation of ",l.a.createElement("a",{href:"http://asherv.com/threes/"},"Threes!"),", the ",l.a.createElement("a",{href:"https://itunes.apple.com/us/app/threes/id779157948?mt=8"},"iOS puzzle game"),"."),l.a.createElement("p",null,"Created by ",l.a.createElement("a",{href:"https://www.laurennishizaki.com"},"Lauren Nishizaki"),"."),l.a.createElement(p,null))}function v(e){return null===e?null:0===e||1===e?0:Math.pow(3,e-1)}function f(e){return null===e?null:0===e||1===e?e+1:3*Math.pow(2,e-2)}var b=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getClassName",value:function(e,t){var a="game-tile game-tile-value-"+e;return t?a+" "+t:a}},{key:"renderDisplay",value:function(e){return null===e?null:l.a.createElement("span",null,f(e))}},{key:"renderScore",value:function(e){var t=v(e);return(this.props.gameOver||p.isType("displayScores"))&&"nextTile"!==this.props.type&&null!==t?l.a.createElement("span",{className:"score"},t):null}},{key:"renderAnimatedTile",value:function(e,t,a,n,r){var s="animate-"+r,i=null===e?null:this.renderStaticTile(e,"no-animate"),u=null===t?null:this.renderStaticTile(t,s),c=null===a?null:this.renderStaticTile(a,"animate-delay"),o=null===n?null:this.renderStaticTile(n,"animate-remove");return l.a.createElement("div",{className:"GameTile animatedGroup"},i,u,c,o)}},{key:"renderStaticTile",value:function(e,t){return l.a.createElement("div",{className:this.getClassName(e,t)},this.renderDisplay(e),this.renderScore(e),p.isType("showTileLogic")?this.props.debug:null)}},{key:"render",value:function(){return"background"===this.props.type?l.a.createElement("div",{className:"GameTile background"}):this.props.doAnimations?this.renderAnimatedTile(this.props.baseValue,this.props.moveValue,this.props.overlayValue,this.props.removeValue,this.props.animateDirection):this.renderStaticTile(this.props.value,"GameTile")}}]),t}(l.a.Component),y=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"reverseDirection",value:function(e){switch(e){case"up":return"down";case"right":return"left";case"down":return"up";case"left":return"right";default:return null}}},{key:"getUndoTileValues",value:function(e,t,a,n,l,r){var s=this.reverseDirection(r.movePos),i=null,u=null,c=null,o="undo;",m=l.gameTiles[e][t],h=r?r.gameTiles[e][t]:null,p=r.moveTiles[e][t];return"new"===p?(o+="new-R;",c=h,null!==m&&(o+="M;",u=m)):!0===p?(u=m,o+="moveT-M;"):(i=m,o+="moveT-B;"),[i,u,null,c,s,o]}},{key:"getTileValues",value:function(e,t,a,n,l,r){var s,i,u=this.props.animateUndo?this.reverseDirection(r.movePos):l.movePos,c=null,o=null,m=null,h=!1,p="";switch(u){case"up":e>=a&&(h=!0),s=e+1,i=t;break;case"right":t<=0&&(h=!0),s=e,i=t-1;break;case"down":e<=0&&(h=!0),s=e-1,i=t;break;case"left":t>=n&&(h=!0),s=e,i=t+1;break;default:h=!0}var d=l.moveTiles[e][t],v=h?null:l.moveTiles[s][i],f=l.gameTiles[e][t],b=r?r.gameTiles[e][t]:null,y=r&&!h?r.gameTiles[s][i]:null;return"new"===d?(m=f,p+="new O;"):h?(p+="baseCase-",!1!==d&&null!==d||(c=f,p+="B;")):!0===v||"new"===v?(o=y,p+="searchT-M;",!1===d&&null!==b&&(c=b,m=f,p+="sum-BO;")):(c=f,p+="searchF-B;"),[c,o,m,null,u,p]}},{key:"render",value:function(){var e,t,a,n,r,s,u,c=this,o=this.props.currentState.gameTiles,m=o.length-1,h=o[0].length-1,p=this.props.currentState,d=this.props.previousState;return l.a.createElement("div",{className:"Board"},l.a.createElement("div",{className:"background"},o.map((function(e,t){return l.a.createElement("div",{className:"game-row background",key:t},e.map((function(e,a){return l.a.createElement(b,{value:null,type:"background",key:m*t+a})})))}))),l.a.createElement("div",{className:"game-board"},o.map((function(o,v){return l.a.createElement("div",{className:"game-row",key:v},o.map((function(o,f){var y=c.props.animateUndo?c.getUndoTileValues(v,f,m,h,p,d):c.getTileValues(v,f,m,h,p,d),E=Object(i.a)(y,6);return e=E[0],t=E[1],a=E[2],n=E[3],s=E[4],r=E[5],u=m*v+f,u+=null!==t||null!==a?Math.random():0,l.a.createElement(b,{value:o,gameOver:c.props.gameOver,type:"gamePiece",doAnimations:c.props.doAnimations,baseValue:e,moveValue:t,overlayValue:a,removeValue:n,animateDirection:s,debug:r,key:u})})))}))))}}]),t}(l.a.Component),E=a(11),g=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getMarkersSubset",value:function(e,t){var a,n=e.length/t;return a=n<=1?1:n<=2?2:n<=5?5:10*(Math.floor(n/10)+1),Array(Math.floor(e.length/a)).fill(0).map((function(t,n){return e[(n+1)*a-1]}))}},{key:"scatterPlotSize",value:function(e,t,a,n){var l=Object(E.min)([t,n/(3*a)]);return Object(E.max)([l,e])}},{key:"render",value:function(){var e=this,t=this.props.svgWidth,a=this.props.svgHeight,n=40,r=this.props.dataScatter,s=this.props.dataBar,i=a-40-20,u=i-10,c=this.props.xAxisMarkers,o=this.props.yAxisMarkers,m=this.getMarkersSubset(o,Math.floor(i/20)),h=this.getMarkersSubset(c,10),p=[0,0,t,a].join(" "),d=(t-n-10)/s.length,v=function(e){return d*e+10+n},f=function(e){return u*(o.length-e)/o.length+10},b=this.scatterPlotSize(2,5,s.length,t-n-10);return l.a.createElement("svg",{className:"chart PlotScatter",viewBox:p},l.a.createElement("g",{className:"plot",transform:"translate(0,20)"},l.a.createElement("path",{className:"max-values",d:["M",[n,i].join(",")].join(" ")+s.map((function(e,t){return" V"+f(e+1)+" H"+v(t+1)}))+" V"+i}),r.map((function(e,t){return l.a.createElement("g",{transform:"translate("+v(t)+", 0)",key:t},l.a.createElement("circle",{className:"plot-"+e,cx:d/2,cy:f(e+1),r:b}))})),l.a.createElement("g",{className:"axis"},l.a.createElement("line",{className:"yAxis",key:"yAxis",x1:n,y1:"0",x2:n,y2:i}),l.a.createElement("line",{className:"xAxis",key:"xAxis",x1:n,y1:i,x2:t,y2:i}),o.map((function(e){return l.a.createElement("line",{key:e,x1:n-2,y1:f(e+1),x2:n+2,y2:f(e+1)})})),c.map((function(e){return l.a.createElement("line",{key:e,x1:v(e+.5),y1:i-2,x2:v(e+.5),y2:i+2})}))),l.a.createElement("g",{className:"x-axis-label",transform:"translate(0, "+i+")"},h.map((function(t){return l.a.createElement("text",{x:v(t+.5),y:"14.5",dy:".35em",key:t,className:"axis-label"},e.props.xAxisLabels[t])})),l.a.createElement("text",{x:(t-n)/2+n,y:30.5,dy:".35em",key:"label",className:"axis-label"},"move #")),l.a.createElement("g",{className:"y-axis-label"},m.map((function(t){return l.a.createElement("text",{x:n-10,y:9.5+f(t+1),dy:"-.35em",key:t},e.props.yAxisLabels[t])})),l.a.createElement("text",{x:"9.5",y:i/2,key:"label",className:"axis-label",transform:"rotate("+[-90,9.5,i/2].join(",")+")"},"tile value"))),l.a.createElement("g",{transform:"translate("+(n+20)+",0)",className:"legend"},l.a.createElement("g",{transform:"translate(0, 0)"},l.a.createElement("circle",{className:"plot-0",cx:"5",cy:"9.5",r:b}),l.a.createElement("circle",{className:"plot-1",cx:"15",cy:"9.5",r:b}),l.a.createElement("circle",{cx:"25",cy:"9.5",r:b}),l.a.createElement("text",{x:"40",y:"9.5",dy:".35em"},"new tile")),l.a.createElement("g",{transform:"translate(140, 0)"},l.a.createElement("rect",{className:"max-values",width:"30",height:"20",y:"0"}),l.a.createElement("text",{x:"40",y:"9.5",dy:".35em"},"max board value"))))}}]),t}(l.a.Component),k=function(e){function t(){return Object(u.a)(this,t),Object(o.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.data,t=this.props.dataLabels,a=this.props.axisMarkers,n=this.props.axisUnit,r=this.props.svgWidth,s=20*e.length+20,i=function(e){return"translate(0, "+(20*e+20+3)+")"},u=r-50-1,c=function(e,t){return u*t[e]/Object(E.max)(a)},o=[0,0,r,s].join(" ");return l.a.createElement("svg",{className:"chart PlotHorizontalBar",viewBox:o},t.map((function(t,a){return l.a.createElement("g",{transform:i(a),key:t},l.a.createElement("rect",{width:c(a,e),height:"18",x:50}),l.a.createElement("text",{x:45,y:"9.5",dy:".35em"},t))})),l.a.createElement("g",{className:"axis"},l.a.createElement("line",{x1:"0",y1:20,x2:r,y2:20}),a.map((function(e,t){return l.a.createElement("line",{x1:50+c(t,a),y1:"0",x2:50+c(t,a),y2:s,key:"axis-"+e})}))),l.a.createElement("g",{className:"axis-label",transform:"translate(50, 0)"},a.map((function(e,t){return l.a.createElement("text",{x:c(t,a)-5,y:"9.5",dy:".35em",key:"label-"+e},e+n)}))))}}]),t}(l.a.Component),x=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).state={currentTab:null},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"items",value:function(){var e=this;return[{name:"instructions",title:"Instructions",content:function(){return l.a.createElement("div",{className:"tab-content"},l.a.createElement("h2",null,"Instructions for play"),l.a.createElement("p",null,"The goal of Trois is to maximize your score by combining as many tiles as possible."),l.a.createElement("p",null,"Click on the arrow keys to slide all tiles on the board one space in the specified direction. Tiles remain within the game borders; the borders act like walls that tiles are unable to pass through."),l.a.createElement("p",null,"White tiles are multiples of 3. If a white tile is pushed into a stationary tile of the same value, then the tiles will combine into one tile, and their values will add."),l.a.createElement("p",null,"Orange and blue tiles are special. An orange tile will always have a value of 1, and a blue tile will always have a value of 2. An orange tile can only be combined with a blue tile (and vice versa)."),l.a.createElement("p",null,"Remember, everything is based around the number 3!"),l.a.createElement("ul",null,l.a.createElement("li",null,"1 + 2 = 3"),l.a.createElement("li",null,"3 + 3 = 6"),l.a.createElement("li",null,"6 + 6 = 12"),l.a.createElement("li",null,"etc.")),l.a.createElement("p",null,"After every move, a new tile is randomly placed onto the board. The value of this tile is randomly chosen, and cannot be larger than the largest-value tile already on the board."),l.a.createElement("h3",null,"Game over"),l.a.createElement("p",null,"The game ends when no more moves can be made."),l.a.createElement("h3",null,"Scoring"),l.a.createElement("p",null,"Your score is the sum of the scores of every tile on the board."),l.a.createElement("p",null,"Tiles with a value of 1 or 2 have a score of 0."),l.a.createElement("p",null,"For all other tiles, the displayed value and score are calculated based on an assigned rank. For example:"),l.a.createElement("table",{className:"example"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Tile rank"),l.a.createElement("th",null,"Tile val",l.a.createElement("span",{className:"wide"},"ue")),l.a.createElement("th",null,"Val",l.a.createElement("span",{className:"wide"},"ue")," calc",l.a.createElement("span",{className:"wide"},"ulation")),l.a.createElement("th",null,"Tile score"),l.a.createElement("th",null,"Score calc",l.a.createElement("span",{className:"wide"},"ulation")))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"0"),l.a.createElement("td",null,"3"),l.a.createElement("td",null,"3 \xd7 2 ^ 0"),l.a.createElement("td",null,"3"),l.a.createElement("td",null,"3 ^ 1")),l.a.createElement("tr",null,l.a.createElement("td",null,"1"),l.a.createElement("td",null,"6"),l.a.createElement("td",null,"3 \xd7 2 ^ 1"),l.a.createElement("td",null,"9"),l.a.createElement("td",null,"3 ^ 2")),l.a.createElement("tr",null,l.a.createElement("td",null,"2"),l.a.createElement("td",null,"12"),l.a.createElement("td",null,"3 \xd7 2 ^ 2"),l.a.createElement("td",null,"27"),l.a.createElement("td",null,"3 ^ 3")),l.a.createElement("tr",null,l.a.createElement("td",null,"3"),l.a.createElement("td",null,"24"),l.a.createElement("td",null,"3 \xd7 2 ^ 3"),l.a.createElement("td",null,"81"),l.a.createElement("td",null,"3 ^ 4")))),l.a.createElement("p",null,"In the general case, the equations are as follows:"),l.a.createElement("table",{className:"general"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Tile rank"),l.a.createElement("th",null,"Value equation"),l.a.createElement("th",null,"Score equation"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,"x"),l.a.createElement("td",null,"3 \xd7 2 ^ x"),l.a.createElement("td",null,"3 ^ (x + 1)")))))}},{name:"statistics",title:"Statistics",content:function(){return l.a.createElement("div",{className:"tab-content"},l.a.createElement("h2",null,"Game statistics"),l.a.createElement("h3",null,"Frequency of new tiles"),l.a.createElement("p",null,"New tiles are randomly selected from a list of all tiles less than or equal to the largest tile on the board."),e.drawNewTiles(),l.a.createElement("h3",null,"Moves and game style"),l.a.createElement("p",null,"This is a summary of all played moves:"),e.drawMoves())}},{name:"about",title:"About",content:function(){return l.a.createElement("div",{className:"tab-content"},l.a.createElement("h2",null,"About Trois"),l.a.createElement("p",null,"Trois is my personal learning project; it is the first project that I\u2019ve built in React (excluding the ",l.a.createElement("a",{href:"https://reactjs.org/tutorial/tutorial.html"},"official tutorial"),"). For project inspiration, I turned to my favorite iOS game, Threes!."),l.a.createElement("p",null,"Source code for the project is on ",l.a.createElement("a",{href:"https://github.com/lemonnish/trois"},"Github"),"."),l.a.createElement("p",null,"The technical writeup is located on ",l.a.createElement("a",{href:"https://www.laurennishizaki.com/projects/2018/09/trois/"},"my personal website"),"."))}}]}},{key:"drawMoves",value:function(){var e=[0,0,0,0];this.props.history.slice(0,this.props.stepNumber+1).forEach((function(t){switch(t.movePos){case"up":e[0]+=1;break;case"right":e[1]+=1;break;case"down":e[2]+=1;break;case"left":e[3]+=1}}));var t=e.map((function(t){return 0===Object(E.sum)(e)?0:100*t/Object(E.sum)(e)}));return l.a.createElement(k,{data:t,dataLabels:["up","right","down","left"],axisMarkers:[0,25,50,75,100],axisUnit:"%",svgWidth:800})}},{key:"drawNewTiles",value:function(){var e=this.props.history.slice(0,this.props.stepNumber),t=e.map((function(e){return e.nextTile})),a=0===e.length?[]:e.map((function(e){return Object(E.max)(e.gameTiles.map((function(e){return Object(E.max)(e)})))})),n=t.map((function(e,t){return t})),r=0===a.length?[0,1]:Array(Object(E.max)(a)+1).fill(0).map((function(e,t){return t})),s=n.map((function(e){return e+1})),i=r.map((function(e){return f(e)}));return l.a.createElement(g,{xAxisMarkers:n,yAxisMarkers:r,xAxisTitle:"move #",yAxisTitle:"tile value",xAxisLabels:s,yAxisLabels:i,dataScatter:t,dataBar:a,svgWidth:800,svgHeight:200})}},{key:"onTabClick",value:function(e){var t=null;this.state.currentTab!==e&&(t=e),this.setState({currentTab:t})}},{key:"renderTabButton",value:function(e,t){var a=this,n=e.name;this.state.currentTab===t&&(n+=" active");var r=(this.state.currentTab===t?"Hide":"Show")+" "+e.name;return l.a.createElement("button",{className:n,key:t,title:r,onClick:function(){return a.onTabClick(t)}},e.title)}},{key:"renderContent",value:function(e){return null!==e?this.items()[e].content():null}},{key:"render",value:function(){var e=this,t="tab-buttons";return null!==this.state.currentTab&&(t+=" active"),l.a.createElement("div",{className:"Tabs"},l.a.createElement("div",{className:t},this.items().map((function(t,a){return e.renderTabButton(t,a)}))),this.renderContent(this.state.currentTab))}}]),t}(l.a.Component);function T(e,t){var a=void 0===t?"Icon":"Icon "+t,n="./static/feather-sprite.svg#"+e;return l.a.createElement("svg",{className:a},l.a.createElement("use",{xlinkHref:n}))}function w(e){var t=["W","D","S","A"],a=["arrow-up","arrow-right","arrow-down","arrow-left"];return l.a.createElement("div",{className:"GameControl"},["up","right","down","left"].map((function(n,r){return l.a.createElement("button",{className:n,onClick:function(){return e.onClick(n)},disabled:null===e.possibleMove[n],title:"Move tiles "+n,key:n},T(a[r]),function(a){return e.showKeyboardShortcuts?l.a.createElement("span",{className:"keyboardShortcut"},t[a]):null}(r))})))}var N=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).state={showKeyboardShortcuts:!0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"renderStatus",value:function(e,t){var a=this,n=function(e,t){return e+t},r=e.map((function(e){return e.map((function(e){return v(e)})).reduce(n)})).reduce(n).toLocaleString();return l.a.createElement("div",{className:"game-status"},a.props.possibleMoves.gameOver?l.a.createElement("div",{className:"next-tile"},l.a.createElement("span",{className:"game-over"},"No remaining moves!")):l.a.createElement("div",{className:"next-tile"},l.a.createElement("label",null,"Next tile"),l.a.createElement(b,{value:t,gameOver:!1,key:"nextTile",type:"nextTile"})),l.a.createElement("div",{className:"score"},l.a.createElement("label",null,"Score"),l.a.createElement("span",{className:"score"},r)))}},{key:"renderToggleShortcuts",value:function(){var e=this,t=this.state.showKeyboardShortcuts?"eye-off":"eye",a=(this.state.showKeyboardShortcuts?"Hide":"Show")+" keyboard shortcuts";return l.a.createElement("button",{className:"toggleShortcuts",onClick:function(){return function(){var t=e.state.showKeyboardShortcuts;e.setState({showKeyboardShortcuts:!t})}()},title:a},T(t),l.a.createElement("span",null,"ABC"))}},{key:"renderUndo",value:function(e,t){var a=this;return l.a.createElement("button",{className:"undo",onClick:this.props.undoClick,disabled:t<=0,title:"Undo last move",key:"undoButton"},"Undo last move",a.state.showKeyboardShortcuts?l.a.createElement("span",{className:"keyboardShortcut"},"U"):null)}},{key:"renderRestart",value:function(){return l.a.createElement("button",{className:"restart",onClick:this.props.restartClick,title:"Restart game"},"Restart")}},{key:"render",value:function(){var e=this.props.state,t=e.history[e.stepNumber].gameTiles,a=e.history[e.stepNumber].nextTile,n=e.history;return l.a.createElement("div",{className:"Dashboard"},this.renderStatus(t,a),l.a.createElement(w,{possibleMove:this.props.possibleMoves,onClick:this.props.controllerClick,showKeyboardShortcuts:this.state.showKeyboardShortcuts}),this.renderUndo(n,e.stepNumber),this.renderToggleShortcuts(),this.renderRestart())}}]),t}(l.a.Component),O=a(350),j=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(o.a)(this,Object(m.a)(t).call(this,e))).state={width:4,height:4,history:[{gameTiles:a.getStartTiles(4,4),moveTiles:S(4,4,null),movePos:null,nextTile:p.isType("noNewTiles")?null:Math.round(Math.random())}],stepNumber:0,prevStepNumber:null,doAnimations:!0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getStartTiles",value:function(e,t){var a,n=Array(e*t).fill(0).map((function(e,t){return t})),l=!0,r=S(t,e,null),s=function(e){return e%2===0};return p.isType("noMovesLeft")?(a=Array(e*t).fill(0),p.isType("largeStartValues")?a=a.map((function(e,t){return 0===t?3:t-1})):p.isType("allOnes")||(l=!1,a=a.map((function(t,a){return s(e)?s(a)===s(Math.floor(a/e))?3:4:s(a)?3:4})))):p.isType("largeStartValues")?(l=!1,a=n.map((function(e,t){return 0===t?null:t-1}))):a=p.isType("allOnes")?[0,0,0,0,0,0]:[0,0,0,1,1,1],l&&(n=Object(E.shuffle)(n)),a.forEach((function(a,l){r[Math.floor(n[l]/t)][n[l]%e]=a})),r}},{key:"getNextTile",value:function(e,t){var a=Object(E.max)(e.map((function(e){return Object(E.max)(e)}))),n=p.isType("noNewTiles")?null:0===a?0:Object(E.shuffle)(Array(a).fill(0).map((function(e,t){return t})))[0],l=[],r=this.state.height,s=this.state.width;switch(t){case"up":e[r-1].forEach((function(e,t){null===e&&l.push((r-1)*s+t)}));break;case"right":e.forEach((function(e,t){null===e[0]&&l.push(t*s+0)}));break;case"down":e[0].forEach((function(e,t){null===e&&l.push(t)}));break;case"left":e.forEach((function(e,t){null===e[s-1]&&l.push((t+1)*s-1)}));break;default:return null}0===l.length&&e.forEach((function(e,t){e.forEach((function(e,a){null===e&&l.push(t*s+a)}))}));var i=Object(E.shuffle)(l)[0];return[Math.floor(i/this.state.height),i%this.state.width,n]}},{key:"allPossibleMoves",value:function(e){var t={up:this.possibleMove(e,"up"),right:this.possibleMove(e,"right"),down:this.possibleMove(e,"down"),left:this.possibleMove(e,"left")},a=Object.values(t).every((function(e){return null===e}));return t.gameOver=a,t}},{key:"moveLogic",value:function(e,t,a,n,l){var r,s=null,i=null,u=!1;return n>0&&!1===a&&null!==e?(u=!0,i=e):n>0&&a&&(r=0===e&&1===t||1===e&&0===t,e>1&&e===t&&e===t||r?(u=!0,i=r?2:e+1,a=!1):i=t),l&&a&&(s=e),[s,i,u,a=!!a&&null!==e]}},{key:"possibleMove",value:function(e,t){var a,n,l,r,s,i,u=e.length,c=e[0].length,o=S(u,c,!1),m=S(u,c,null),h=!1;switch(t){case"up":i=new Array(c).fill(!0);for(var p=0;p<u;p++){r=p,s=p===u-1;for(var d=0;d<c;d++)a=e[p][d],n=p>0?e[p-1][d]:null,l=this.moveLogic(a,n,i[d],r,s),s&&(m[p][d]=l[0]),p>0&&(m[p-1][d]=l[1]),h=!!h||l[2],o[p][d]=l[2],i[d]=l[3]}break;case"right":i=new Array(u).fill(!0);for(var v=c-1;v>=0;v--){r=c-v-1,s=0===v;for(var f=0;f<u;f++)a=e[f][v],n=v<c-1?e[f][v+1]:null,l=this.moveLogic(a,n,i[f],r,s),s&&(m[f][v]=l[0]),v<c-1&&(m[f][v+1]=l[1]),h=!!h||l[2],o[f][v]=l[2],i[f]=l[3]}break;case"down":i=new Array(c).fill(!0);for(var b=u-1;b>=0;b--){r=u-b-1,s=0===b;for(var y=0;y<c;y++)a=e[b][y],n=b<u-1?e[b+1][y]:null,l=this.moveLogic(a,n,i[y],r,s),s&&(m[b][y]=l[0]),b<u-1&&(m[b+1][y]=l[1]),h=!!h||l[2],o[b][y]=l[2],i[y]=l[3]}break;case"left":i=new Array(u).fill(!0);for(var E=0;E<c;E++){r=E,s=E===c-1;for(var g=0;g<u;g++)a=e[g][E],n=E>0?e[g][E-1]:null,l=this.moveLogic(a,n,i[g],r,s),s&&(m[g][E]=l[0]),E>0&&(m[g][E-1]=l[1]),h=!!h||l[2],o[g][E]=l[2],i[g]=l[3]}break;default:return null}return h?{movement:o,nextState:m}:null}},{key:"handleClick",value:function(e){var t=this.state.history.slice(0,this.state.stepNumber+1),a=t[this.state.stepNumber],n=this.allPossibleMoves(a.gameTiles);if(null!==n[e]){var l=n[e].nextState,r=n[e].movement,s=this.getNextTile(l,e),u=Object(i.a)(s,3),c=u[0],o=u[1],m=u[2];l[c][o]=a.nextTile,r[c][o]="new",this.setState({history:t.concat([{gameTiles:l,moveTiles:r,movePos:e,nextTile:m}]),stepNumber:t.length,prevStepNumber:t.length-1})}}},{key:"handleUndoClick",value:function(){var e=this.state.stepNumber;e<1||this.setState({stepNumber:e-1,prevStepNumber:e})}},{key:"handleRestartClick",value:function(){this.setState({history:[{gameTiles:this.getStartTiles(4,4),moveTiles:S(4,4,null),movePos:null,nextTile:Math.round(Math.random())}],stepNumber:0,prevStepNumber:null})}},{key:"handleKeypress",value:function(){var e=this;O.bind("w",(function(){return e.handleClick("up")})),O.bind("d",(function(){return e.handleClick("right")})),O.bind("s",(function(){return e.handleClick("down")})),O.bind("a",(function(){return e.handleClick("left")})),O.bind("u",(function(){return e.handleUndoClick()}))}},{key:"render",value:function(){var e=this,t=this.state.stepNumber,a=this.state.prevStepNumber,n=this.state.history[t],r=null!==a?this.state.history[a]:null,s=a>t,i=this.allPossibleMoves(n.gameTiles);return this.handleKeypress(),l.a.createElement("div",{className:"Game"},l.a.createElement(d,null),l.a.createElement(y,{currentState:n,previousState:r,gameOver:i.gameOver,doAnimations:this.state.doAnimations,animateUndo:s}),l.a.createElement(N,{state:this.state,controllerClick:function(t){return e.handleClick(t)},undoClick:function(){return e.handleUndoClick()},possibleMoves:i,restartClick:function(){return e.handleRestartClick()}}),l.a.createElement(x,{history:this.state.history,stepNumber:this.state.stepNumber}))}}]),t}(l.a.Component);function S(e,t,a){for(var n=new Array(e),l=0;l<e;l++)n[l]=new Array(t).fill(a);return n}a(351);s.a.render(l.a.createElement(j,null),document.getElementById("trois-game"))}},[[138,1,2]]]);
//# sourceMappingURL=main.db43e120.chunk.js.map